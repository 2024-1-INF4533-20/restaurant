<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pizza Info</title>
  <link rel="icon" type="image/x-icon" href="/Images/logo.ico">
  <link rel="stylesheet" href="styles.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link rel="stylesheet" href="styleshistoriques.css">

</head>

<body>
  <header> <!--Barre de naviguation-->
    <ul class="topnav">
      <li><img src="Images/logo.png" width="200" alt="logo" id="logoImg"></li>
      <li class="libr"><a href="menu.html">Pizza Info</a></li>
      <li class="libr"><a href="menu.html">Menu </a></li>
      <li class="libr"><a href="contact.html">Informations</a></li>
      <li class="libr"><a href="historique.html">Historique de commande</a></li>
      <li class="libr"><a href="panier.html">Mon panier</a></li>
      <li class="libr"><a href="connexion.html">Connexion</a></li>
    </ul>
  </header>

  <div class="background backcomplet">
    <section class="row justify-content-center"><!--Section de la liste de l'historique des commandes-->
      <table id="monHistorique">
        <tr>
          <td style="width: 30%; margin-left: 150px;">
            <div class="tab">
              <!--bouttons sur le côté-->
            </div>
          </td>

          <td>
            <section class="content">
              <!--infos des commandes-->
            </section>
          </td>
        </tr>
      </table>
      

      <!--<div id="Commande1" class="tabcontent"> div qui contient les informations de la commande-->
      

      <script>
        const mesBoutons = document.querySelector('div.tab');
        const mesCommandes = document.querySelector('section.content');
              fetch('./datajson/historique.json')
                .then(res => res.json())
                .then(data =>{
                  let commandes = data;
                  console.log(commandes);

                  commandes.forEach(p => {
                    mesBoutons.insertAdjacentHTML('beforeend', `<button class="tablinks" onclick="commandee(event, '${p.numeroCommande}')">${p.numeroCommande}</button>`)
                    mesCommandes.insertAdjacentHTML('beforeend', `<div id="${p.numeroCommande}" class="tabcontent"><h3>${p.numeroCommande}</h3>
                    <p>Commande au nom de ${p.nom}
                    <br>
                    ${p.commande}<br>
                    Prix total de la commande (taxes incluses) : ${p.prix}
                    <br>${p.date}
                    <br> Adresse : ${p.adresse}
                    </p>
                    </div>`);
                    
                  });
                  //ceci rend les commandes invisibles jusqu'à ce qu'une commande soit sélectionnée
                  tabcontent = document.getElementsByClassName("tabcontent");
                  for (i = 0; i < tabcontent.length; i++) {
                    tabcontent[i].style.display = "none";
                  }
                })
      </script>
      

      <script> /*Fonction qui permet d'afficher toutes les commandes et d'afficher la description d'une seule commande à la fois */
        function commandee(evt, commandenom) {
          var i, tabcontent, tablinks;
          tabcontent = document.getElementsByClassName("tabcontent");
          for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
          }
          tablinks = document.getElementsByClassName("tablinks");
          for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
          }
          document.getElementById(commandenom).style.display = "block";
          evt.currentTarget.className += " active";
        }

        // Get the element with id="defaultOpen" and click on it
        document.getElementById("defaultOpen").click();
      </script>

    </section>
  </div>

  <!-- footer -->
  <footer>
    <ul class="bottomnav">
      <li><a href="">Commentaires</a></li>
      <li><a href="contact.html">À propos de nous</a></li>
      <li><a><img src="Images/logo-facebook.png" width="80" alt="facebook"></a></li>
      <li><a href="#top">Haut de la page</a></li>
    </ul>
  </footer>

</body>

</html>